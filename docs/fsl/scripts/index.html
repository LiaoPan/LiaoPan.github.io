<!DOCTYPE html>
<html lang="zh-cn" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="baidu-site-verification" content="code-mkEaOD4c4c" />
    <meta name="generator" content="Hugo 0.109.0">
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>FSL系列教程 #5. FSL脚本编写 :: 脑技术计划</title>

    
    <link href="/css/nucleus.css?1701594111" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1701594111" rel="stylesheet">
    <link href="/css/hybrid.css?1701594111" rel="stylesheet">
    <link href="/css/featherlight.min.css?1701594111" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1701594111" rel="stylesheet">
    <link href="/css/auto-complete.css?1701594111" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1701594111" rel="stylesheet">
    <link href="/css/theme.css?1701594111" rel="stylesheet">
    <link href="/css/tabs.css?1701594111" rel="stylesheet">
    <link href="/css/hugo-theme.css?1701594111" rel="stylesheet">
    
    <link href="/css/theme-green.css?1701594111" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1701594111"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

<script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>


  </head>
  <body class="" data-url="/fsl/scripts/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      

<a id="logo" href='/'>
   
   <svg t="1672992984210" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4015" width="64" height="64">
      <path d="M358.4 621.226667c-6.826667 0-167.253333-3.413333-187.733333-102.4-54.613333-3.413333-92.16-13.653333-116.053334-37.546667-10.24-10.24-17.066667-23.893333-20.48-30.72-10.24-6.826667-23.893333-17.066667-30.72-40.96-3.413333-17.066667-3.413333-37.546667-3.413333-44.373333 0-17.066667 6.826667-174.08 215.04-256 208.213333-78.506667 436.906667-47.786667 525.653333 34.133333 95.573333 3.413333 170.666667 95.573333 177.493334 180.906667 6.826667 75.093333-37.546667 167.253333-174.08 191.146666-47.786667 58.026667-150.186667 68.266667-242.346667 75.093334-54.613333 6.826667-109.226667 10.24-136.533333 23.893333 0 3.413333-3.413333 6.826667-6.826667 6.826667zM204.8 498.346667c0 75.093333 126.293333 85.333333 150.186667 85.333333 34.133333-17.066667 85.333333-20.48 143.36-27.306667 85.333333-6.826667 184.32-17.066667 221.866666-68.266666 3.413333-3.413333 6.826667-6.826667 10.24-6.826667 102.4-17.066667 160.426667-78.506667 153.6-157.013333-6.826667-71.68-68.266667-150.186667-150.186666-150.186667-3.413333 0-10.24-3.413333-13.653334-3.413333-71.68-75.093333-293.546667-105.813333-491.52-30.72C40.96 211.626667 34.133333 348.16 34.133333 365.226667c0 6.826667 0 23.893333 3.413334 34.133333 3.413333 17.066667 10.24 17.066667 13.653333 17.066667 3.413333 0 10.24 3.413333 13.653333 3.413333 0 3.413333 3.413333 6.826667 3.413334 13.653333 0 0 3.413333 47.786667 102.4 51.2 3.413333-17.066667 10.24-34.133333 20.48-44.373333 27.306667-27.306667 71.68-23.893333 119.466666-20.48 27.306667 0 54.613333 3.413333 75.093334 0 10.24-3.413333 17.066667 3.413333 20.48 13.653333 0 10.24-3.413333 17.066667-13.653334 20.48-27.306667 3.413333-54.613333 3.413333-85.333333 3.413334-37.546667-3.413333-78.506667-3.413333-95.573333 13.653333-3.413333 0-6.826667 10.24-6.826667 27.306667z" fill="#ffffff" p-id="4016"></path><path d="M597.333333 962.56h-102.4c-6.826667 0-13.653333-6.826667-17.066666-13.653333l-64.853334-259.413334C341.333333 682.666667 307.2 645.12 286.72 624.64c-3.413333-3.413333-6.826667-6.826667-6.826667-10.24-6.826667-6.826667-6.826667-17.066667 0-23.893333s17.066667-6.826667 23.893334 0l10.24 10.24c20.48 20.48 47.786667 54.613333 116.053333 54.613333 6.826667 0 13.653333 6.826667 17.066667 13.653333l64.853333 259.413334h68.266667l-34.133334-150.186667c-3.413333-10.24 3.413333-17.066667 13.653334-20.48 10.24-3.413333 17.066667 3.413333 20.48 13.653333l34.133333 170.666667c0 3.413333 0 10.24-3.413333 13.653333s-10.24 6.826667-13.653334 6.826667z" fill="#ffffff" p-id="4017"></path><path d="M699.733333 826.026667c-105.813333 0-187.733333-44.373333-187.733333-102.4s81.92-102.4 187.733333-102.4 187.733333 44.373333 187.733334 102.4-81.92 102.4-187.733334 102.4z m0-170.666667c-92.16 0-153.6 37.546667-153.6 68.266667s61.44 68.266667 153.6 68.266666 153.6-37.546667 153.6-68.266666-61.44-68.266667-153.6-68.266667z" fill="#ffffff" p-id="4018"></path><path d="M853.333333 689.493333c-10.24 0-17.066667-6.826667-17.066666-17.066666s6.826667-17.066667 17.066666-17.066667c68.266667 0 136.533333-23.893333 136.533334-51.2 0-20.48-47.786667-30.72-68.266667-34.133333-10.24 0-17.066667-10.24-17.066667-17.066667 0-10.24 6.826667-17.066667 17.066667-17.066667 51.2 0 58.026667-27.306667 61.44-44.373333 6.826667-68.266667-61.44-170.666667-78.506667-177.493333-10.24 0-17.066667-6.826667-17.066666-17.066667s6.826667-17.066667 17.066666-17.066667c44.373333 0 112.64 119.466667 112.64 197.973334 0 27.306667-6.826667 47.786667-23.893333 64.853333l-10.24 10.24c20.48 10.24 37.546667 27.306667 37.546667 51.2 3.413333 58.026667-95.573333 85.333333-167.253334 85.333333zM494.933333 314.026667c-3.413333 0-6.826667 0-10.24-3.413334-6.826667-3.413333-10.24-13.653333-6.826666-23.893333 3.413333-6.826667 88.746667-143.36 252.586666-143.36 10.24 0 17.066667 6.826667 17.066667 17.066667s-6.826667 17.066667-17.066667 17.066666c-146.773333 0-221.866667 126.293333-225.28 129.706667 0 3.413333-3.413333 6.826667-10.24 6.826667zM733.866667 518.826667c-20.48 0-37.546667-6.826667-51.2-23.893334-37.546667-40.96-34.133333-126.293333-34.133334-129.706666 0-10.24 10.24-17.066667 17.066667-17.066667 10.24 0 17.066667 10.24 17.066667 17.066667 0 20.48 0 78.506667 23.893333 105.813333 6.826667 6.826667 17.066667 13.653333 27.306667 13.653333 10.24 0 17.066667 6.826667 17.066666 17.066667 0 6.826667-6.826667 17.066667-17.066666 17.066667zM802.133333 382.293333c-10.24 0-17.066667-6.826667-17.066666-17.066666 0-51.2-85.333333-51.2-85.333334-51.2-10.24 0-17.066667-6.826667-17.066666-17.066667s6.826667-17.066667 17.066666-17.066667c58.026667 0 119.466667 27.306667 119.466667 85.333334 0 6.826667-6.826667 17.066667-17.066667 17.066666z" fill="#ffffff" p-id="4019"></path><path d="M494.933333 484.693333c-10.24 0-17.066667-6.826667-17.066666-17.066666s6.826667-17.066667 17.066666-17.066667c17.066667 0 51.2-40.96 51.2-85.333333 0-10.24 6.826667-17.066667 17.066667-17.066667s17.066667 6.826667 17.066667 17.066667c0 54.613333-44.373333 119.466667-85.333334 119.466666z" fill="#ffffff" p-id="4020"></path><path d="M187.733333 314.026667c-3.413333 0-6.826667 0-10.24-3.413334-34.133333-20.48-47.786667-51.2-47.786666-71.68-6.826667-34.133333 13.653333-78.506667 47.786666-109.226666 6.826667-6.826667 17.066667-6.826667 23.893334 0 6.826667 6.826667 3.413333 17.066667-3.413334 23.893333-23.893333 23.893333-37.546667 58.026667-34.133333 81.92 3.413333 17.066667 13.653333 34.133333 34.133333 44.373333 6.826667 6.826667 10.24 17.066667 3.413334 23.893334-3.413333 6.826667-6.826667 10.24-13.653334 10.24z" fill="#ffffff" p-id="4021"></path><path d="M290.133333 314.026667c-10.24 0-17.066667-10.24-17.066666-17.066667s6.826667-17.066667 17.066666-17.066667c81.92 0 85.333333-119.466667 85.333334-119.466666 0-10.24 6.826667-17.066667 17.066666-17.066667s17.066667 6.826667 17.066667 17.066667c0 37.546667-20.48 153.6-119.466667 153.6z" fill="#ffffff" p-id="4022"></path>
   </svg>
   
   <svg id="grav-logo" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
      width="100%" height="100%"  viewBox="55 0 285.1 69.9" xml:space="preserve">
   <g>
      <path d="M116.6,51.3h-29c-0.5,0-0.9-0.1-1.3-0.2c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-1c-0.2-0.4-0.2-0.8-0.2-1.3V16.3h6.3
         V45h25.8V51.3z"/>
      <path d="M154.8,51.3h-22.9c-0.9,0-1.8-0.2-2.9-0.5c-1-0.3-2-0.8-2.9-1.5c-0.9-0.7-1.6-1.6-2.2-2.8c-0.6-1.1-0.9-2.5-0.9-4.2V19.5
         c0-0.4,0.1-0.9,0.2-1.2c0.2-0.4,0.4-0.7,0.7-1c0.3-0.3,0.6-0.5,1-0.7c0.4-0.2,0.8-0.2,1.3-0.2h28.6v6.3h-25.4v19.8
         c0,0.8,0.2,1.5,0.7,1.9s1.1,0.7,1.9,0.7h22.9V51.3z M151.9,37h-20v-6.4h20V37z"/>
      <path d="M197.3,51.3H191v-8.6h-22.3v8.6h-6.3V33.8c0-2.6,0.4-4.9,1.3-7.1s2.1-4,3.7-5.5c1.6-1.5,3.4-2.8,5.5-3.6
         c2.1-0.9,4.5-1.3,7-1.3h14.3c0.4,0,0.9,0.1,1.2,0.2c0.4,0.2,0.7,0.4,1,0.7s0.5,0.6,0.7,1c0.2,0.4,0.2,0.8,0.2,1.2V51.3z
          M168.7,36.4H191V22.6h-11.2c-0.2,0-0.6,0-1.2,0.1c-0.6,0.1-1.4,0.2-2.2,0.4c-0.8,0.2-1.7,0.6-2.6,1c-0.9,0.5-1.8,1.1-2.5,2
         c-0.8,0.8-1.4,1.9-1.9,3.1c-0.5,1.2-0.7,2.8-0.7,4.5V36.4z"/>
      <path d="M241.7,28.1c0,1.4-0.2,2.7-0.5,3.9c-0.4,1.1-0.8,2.1-1.5,3c-0.6,0.9-1.3,1.6-2.1,2.2c-0.8,0.6-1.6,1.1-2.5,1.5
         c-0.9,0.4-1.8,0.7-2.6,0.9c-0.9,0.2-1.7,0.3-2.5,0.3l13.3,11.5h-9.8l-13.2-11.5h-4.6v-6.3H230c0.8-0.1,1.5-0.2,2.2-0.5
         c0.7-0.3,1.2-0.6,1.7-1.1c0.5-0.5,0.9-1,1.1-1.6c0.3-0.6,0.4-1.4,0.4-2.2v-4c0-0.4,0-0.6-0.1-0.8c-0.1-0.2-0.2-0.3-0.3-0.4
         c-0.1-0.1-0.3-0.1-0.4-0.2c-0.2,0-0.3,0-0.4,0h-20.9v28.7h-6.3V19.5c0-0.4,0.1-0.9,0.2-1.2c0.2-0.4,0.4-0.7,0.7-1
         c0.3-0.3,0.6-0.5,1-0.7c0.4-0.2,0.8-0.2,1.3-0.2H234c1.4,0,2.6,0.3,3.6,0.8s1.8,1.2,2.4,1.9c0.6,0.8,1,1.6,1.3,2.5
         c0.3,0.9,0.4,1.7,0.4,2.5V28.1z"/>
      <path d="M285.1,48.6c0,0.5-0.1,0.9-0.3,1.3c-0.2,0.4-0.4,0.7-0.7,1c-0.3,0.3-0.6,0.5-1,0.7c-0.4,0.2-0.8,0.2-1.2,0.2
         c-0.4,0-0.8-0.1-1.2-0.2c-0.4-0.1-0.8-0.4-1.1-0.7l-23.2-24.2v24.7h-6.3V19c0-0.7,0.2-1.2,0.5-1.8c0.4-0.5,0.8-0.9,1.4-1.2
         c0.6-0.2,1.2-0.3,1.9-0.2s1.2,0.4,1.6,0.9l23.2,24.2V16.3h6.3V48.6z"/>
   </g>
   </svg>


   
   </a>
   

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="搜索...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1701594111"></script>
<script type="text/javascript" src="/js/auto-complete.js?1701594111"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/LiaoPan.github.io";
    
</script>
<script type="text/javascript" src="/js/search.js?1701594111"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/basics/" title="基础知识" class="dd-item
        
        
        
        ">
      <a href="/basics/">
          <b>1. </b>基础知识
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/datasets/" title="脑相关数据集" class="dd-item
        
        
        
        ">
      <a href="/datasets/">
          <b>2. </b>脑相关数据集
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dipy/" title="DIPY系列教程" class="dd-item
        
        
        
        ">
      <a href="/dipy/">
          <b>3. </b>DIPY系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/dipy/basic/" title="快速入门" class="dd-item ">
        <a href="/dipy/basic/">
        <b>1. </b>快速入门
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dipy/tracking_basic/" title="纤维束追踪入门" class="dd-item ">
        <a href="/dipy/tracking_basic/">
        <b>2. </b>纤维束追踪入门
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/mrtrix/" title="MRtrix3系列教程" class="dd-item
        
        
        
        ">
      <a href="/mrtrix/">
          <b>4. </b>MRtrix3系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/mrtrix/basic/" title="MRtrix3教程 #1 快速入门" class="dd-item ">
        <a href="/mrtrix/basic/">
        <b>1. </b>MRtrix3教程 #1 快速入门
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/mrtrix/preprocessing/" title="MRtrix3教程 #2 预处理" class="dd-item ">
        <a href="/mrtrix/preprocessing/">
        <b>2. </b>MRtrix3教程 #2 预处理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/mrtrix/tissue_boundary/" title="MRtrix3教程 #4 大脑组织边界" class="dd-item ">
        <a href="/mrtrix/tissue_boundary/">
        <b>4. </b>MRtrix3教程 #4 大脑组织边界
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/mrtrix/connectome/" title="MRtrix3教程 #6 Connectome" class="dd-item ">
        <a href="/mrtrix/connectome/">
        <b>6. </b>MRtrix3教程 #6 Connectome
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/afni/" title="AFNI系列教程" class="dd-item
        
        
        
        ">
      <a href="/afni/">
          <b>5. </b>AFNI系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/afni/preprocess/" title="AFNI 系列教程 #1.Preprocessing" class="dd-item ">
        <a href="/afni/preprocess/">
        <b>1. </b>AFNI 系列教程 #1.Preprocessing
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/afni/stats/" title="AFNI 系列教程 #2.统计与建模" class="dd-item ">
        <a href="/afni/stats/">
        <b>2. </b>AFNI 系列教程 #2.统计与建模
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/eeglab/" title="EEGLAB系列教程" class="dd-item
        
        
        
        ">
      <a href="/eeglab/">
          <b>6. </b>EEGLAB系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fieldtrip/" title="FieldTrip系列教程" class="dd-item
        
        
        
        ">
      <a href="/fieldtrip/">
          <b>7. </b>FieldTrip系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/freesurfer/" title="FreeSurfer系列教程" class="dd-item
        
        
        
        ">
      <a href="/freesurfer/">
          <b>8. </b>FreeSurfer系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/freesurfer/installation/" title="FreeSurfer教程 #1. 安装" class="dd-item ">
        <a href="/freesurfer/installation/">
        FreeSurfer教程 #1. 安装
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/freesurfer/basic/" title="FreeSurfer教程 #2. FreeSurfer输出结果与FreeView可视化" class="dd-item ">
        <a href="/freesurfer/basic/">
        FreeSurfer教程 #2. FreeSurfer输出结果与FreeView可视化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/freesurfer/practice/" title="FreeSurfer教程 #N. 实践教程之CookBook" class="dd-item ">
        <a href="/freesurfer/practice/">
        FreeSurfer教程 #N. 实践教程之CookBook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/fsl/" title="FSL系列教程" class="dd-item
        parent
        
        
        ">
      <a href="/fsl/">
          <b>9. </b>FSL系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/fsl/installation/" title="FSL系列教程 #1.FSL安装" class="dd-item ">
        <a href="/fsl/installation/">
        <b>1. </b>FSL系列教程 #1.FSL安装
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/fsl/preprocess/" title="FSL系列教程 #2. 预处理" class="dd-item ">
        <a href="/fsl/preprocess/">
        <b>2. </b>FSL系列教程 #2. 预处理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/fsl/statistics_analysis/" title="FSL系列教程 #3. 统计与建模 " class="dd-item ">
        <a href="/fsl/statistics_analysis/">
        <b>3. </b>FSL系列教程 #3. 统计与建模 
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/fsl/roi_analysis/" title="FSL系列教程 #4. ROI分析 " class="dd-item ">
        <a href="/fsl/roi_analysis/">
        <b>4. </b>FSL系列教程 #4. ROI分析 
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/fsl/scripts/" title="FSL系列教程 #5. FSL脚本编写" class="dd-item active">
        <a href="/fsl/scripts/">
        <b>5. </b>FSL系列教程 #5. FSL脚本编写
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/spm/" title="SPM系列教程" class="dd-item
        
        
        
        ">
      <a href="/spm/">
          <b>10. </b>SPM系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ants/" title="ANTs系列教程" class="dd-item
        
        
        
        ">
      <a href="/ants/">
          <b>11. </b>ANTs系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/mne/" title="MNE系列教程" class="dd-item
        
        
        
        ">
      <a href="/mne/">
          <b>12. </b>MNE系列教程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> 清理历史记录</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      
<center>
    
    <a class="github-button" href="https://codeload.github.com/LiaoPan/LiaoPan.github.io/zip/refs/heads/master" data-icon="octicon-cloud-download" aria-label="Download on GitHub">Download</a>

    
    <a class="github-button" href="https://github.com/LiaoPan/LiaoPan.github.io" data-icon="octicon-star" data-show-count="true" aria-label="Star on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/LiaoPan/LiaoPan.github.io/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork on GitHub">Fork</a>

    <p><i class="fas fa-heart"></i> 如果觉得喜欢，点个 <a href="https://github.com/LiaoPan/LiaoPan.github.io"><b>Star</b></a> 跟踪最新内容 <i class="fas fa-heart"></i> </p>

</center>


<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>主页</a> > <a href='/fsl/'>FSL系列教程</a> > FSL系列教程 #5. FSL脚本编写
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#简介">简介</a></li>
        <li><a href="#创建脚本模版">创建脚本模版</a></li>
        <li><a href="#运行脚本">运行脚本</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              FSL系列教程 #5. FSL脚本编写
            </h1>
          

        


<h3 id="简介">简介</h3>
<p>在对单个受试者的单次run进行预处理并建立模型之后，我们就需要对数据集中所有受试者的所有run进行相同的处理。这看似繁琐，但也是可行的&ndash;我们只有26个受试者，每个受试者有两次run。我们可能认为这可以在一周左右的时间内完成；而且也可以随时将这项任务分配给几名研究助理。</p>
<p>然而，在某些时候，您会遇到两个问题：</p>
<ol>
<li>我们会发现，手动分析每次运行不仅乏味，而且容易出错，随着要分析的运行数量增加，出错的概率也会显著增加；</li>
<li>对于较大的数据集（例如，80个受试者，每个受试者有5次run），这种方法很快就会变得不切实际。</li>
</ol>
<p>另一种方法是编写分析脚本。就像演员有一个脚本，告诉他说什么、站在哪里、在哪里移动一样，我们也可以编写一个脚本，告诉计算机如何分析数据集。这样做有双重好处，既可以实现分析自动化，又可以分析任何规模的数据集&ndash;分析两个受试者或两百个受试者的代码几乎完全相同。</p>
<p>首先，我们将创建一个模板，其中包含分析单次run所需的代码，然后我们将使用for-loop自动分析所有运行。这个想法很简单；尽管代码一开始可能难以理解，但一旦我们对其更加熟悉，我们就会发现如何将其应用于任何数据集。</p>

<div class="notices note" ><p>理解下述代码脚本需要Linux的shell脚本基础，推荐掌握了基础的shell脚本语法后，再来继续阅读下述内容。</p>
</div>

<h3 id="创建脚本模版">创建脚本模版</h3>
<p>当分析sub-08被试的第一个run时，会创建一个名为<code>run1.feat</code>的目录。在该目录下有几个文件和子目录。其中一个文件<code>design.fsf</code>包含了从FEAT图形用户界面转录到文本文件中的所有代码。这是FSL运行来完成每个预处理和建模步骤的代码。如果在文本编辑器中打开<code>design.fsf</code>f文件和用来创建<code>design.fsf</code>文件的FEAT图形用户界面并排比较，我们可以看到输入到FEAT图形用户界面的数据在哪里被写入<code>design.fsf</code>文件。</p>
<p><img src="/fsl/images/05_FEAT_Design_File.webp" alt="FEAT_Template"></p>
<p>如果我们打开了FEAT图形用户界面，点击屏幕底部的<code>Load</code>按钮，并选择<code>run1.feat</code>目录下的<code>design.fsf</code>文件，它将把所有设置更改为您保存脚本时在图形用户界面中输入的设置。</p>
<p>在前面的教程中，我们分别运行了FEAT的预处理和模型拟合。现在我们将从FEAT GUI的下拉菜单中选择 &ldquo;Full Analysis（全分析）&quot;，创建一个将这两个步骤结合在一起的模板。</p>
<p>首先，输入<code>rm -r run1.feat</code>删除当前<code>run1.feat</code>目录。然后在命令行输入<code>Feat_gui</code>打开FEAT图形用户界面。我们将在下拉菜单中选择 &ldquo;Full Analysis（全面分析）&ldquo;选项，而不是将其作为两个单独的会话来运行。以前面的教程为指导，填写预处理和模型拟合的所有必填项。</p>
<p>填写完所有字段后，不要点击<code>Go</code>按钮，而是点击<code>Save</code>并标注文件为<code>design_run1</code>。这将保存多个扩展名为 &ldquo;con&rdquo;、&ldquo;mat &ldquo;和 &ldquo;png &ldquo;的文件，但我们的脚本将使用文件<code>design_run1.fsf</code>。</p>
<p>现在对run 2执行相同的步骤，加载相应的功能数据和时序文件。将文件保存为<code>design_run2.fsf</code>。</p>
<p>在代码编辑器(或者文本编辑器)中打开<code>design_run1.fsf</code>，查看所有已填写的选项。我们的目标是使该模板可用于任何被试，只需在for-loop中稍作改动即可。在本例中，我们唯一需要更改的是被试名称，其余选项对每个被试都是相同的。</p>
<h3 id="运行脚本">运行脚本</h3>
<p>将<code>design_run1.fsf</code>和<code>design_run2.fsf</code>文件移到包含被试的目录下（即<code>mv design*.fsf ..</code>，然后<code>cd ..</code>）。然后下载脚本 <a href="https://github.com/andrewjahn/FSL_Scripts/blob/master/run_1stLevel_Analysis.sh">run_1stLevel_Analysis.sh</a>(如下述代码所示)，并将其移动到Flanker目录中：</p>


<div class="tab-panel">
    <div class="tab-nav">
    
        <button
          data-tab-item="run_1stLevel_Analysis.sh"
          data-tab-group="default"
          class="tab-nav-button btn active"
          onclick="switchTab('default','run_1stLevel_Analysis.sh')"
         >run_1stLevel_Analysis.sh</button>
    
    </div>
    <div class="tab-content">
        
        <div data-tab-item="run_1stLevel_Analysis.sh" data-tab-group="default" class="tab-item active">
            <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate the subject list to make modifying this script</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># to run just a subset of subjects easier.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 依次遍历26个被试数据</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> id in <span style="color:#e6db74">`</span>seq -w <span style="color:#ae81ff">1</span> 26<span style="color:#e6db74">`</span> ; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    subj<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sub-</span>$id<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;===&gt; Starting processing of </span>$subj<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    echo
</span></span><span style="display:flex;"><span>    cd $subj
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 颅骨去除</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># If the brain mask doesn’t exist, create it</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f anat/<span style="color:#e6db74">${</span>subj<span style="color:#e6db74">}</span>_T1w_brain_f02.nii.gz <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;Skull-stripped brain not found, using bet with a fractional intensity threshold of 0.2&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Note: This fractional intensity appears to work well for most of the subjects in the</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Flanker dataset. You may want to change it if you modify this script for your own study.</span>
</span></span><span style="display:flex;"><span>            bet2 anat/<span style="color:#e6db74">${</span>subj<span style="color:#e6db74">}</span>_T1w.nii.gz <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>                anat/<span style="color:#e6db74">${</span>subj<span style="color:#e6db74">}</span>_T1w_brain_f02.nii.gz -f 0.2
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Copy the design files into the subject directory, and then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># change “sub-08” to the current subject number</span>
</span></span><span style="display:flex;"><span>        cp ../design_run1.fsf .
</span></span><span style="display:flex;"><span>        cp ../design_run2.fsf .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 替换*.fsf中的&#34;sub-08&#34;为当前需要处理的被试名称</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Note that we are using the | character to delimit the patterns</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># instead of the usual / character because there are / characters</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># in the pattern.</span>
</span></span><span style="display:flex;"><span>        sed -i <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#e6db74">&#34;s|sub-08|</span><span style="color:#e6db74">${</span>subj<span style="color:#e6db74">}</span><span style="color:#e6db74">|g&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            design_run1.fsf
</span></span><span style="display:flex;"><span>        sed -i <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#e6db74">&#34;s|sub-08|</span><span style="color:#e6db74">${</span>subj<span style="color:#e6db74">}</span><span style="color:#e6db74">|g&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            design_run2.fsf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 直接使用feat执行*.fsf脚本</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Usage: feat &lt;design.fsf&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Now everything is set up to run feat</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;===&gt; Starting feat for run 1&#34;</span>
</span></span><span style="display:flex;"><span>        feat design_run1.fsf
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;===&gt; Starting feat for run 2&#34;</span>
</span></span><span style="display:flex;"><span>        feat design_run2.fsf
</span></span><span style="display:flex;"><span>                echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Go back to the directory containing all of the subjects, and repeat the loop</span>
</span></span><span style="display:flex;"><span>    cd ..
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo
</span></span></code></pre></div>
        </div>
        
    </div>
</div>

<p>脚本的开头是一个shebang和一些注释，描述了脚本的具体操作；然后使用反引号来扩展<code>seq -w 1 26</code>，以创建一个循环，在所有被试上运行代码的主体。该脚本使用一个条件来检查是否存在颅骨剥离后的结构像数据，如果不存在，则生成。然后编辑模板<code>design*.fsf</code>文件，将字符串sub-08替换为当前受试者的姓名。<code>*.fsf</code>文件使用命令<code>feat</code>运行，就像从命令行运行FEAT图形用户界面一样。整个脚本中都使用了<code>echo</code>命令，让用户知道何时运行新的步骤。</p>
<p>只需在Flanker目录下输入<code>bash run_1stLevel_Analysis.sh</code>即可运行脚本。当运行一个新步骤时，echo命令将向终端打印文本，HTML页面将跟踪预处理和统计的进度。</p>

<div class="notices note" ><p><a href="https://github.com/andrewjahn/FSL_Scripts">更多的脚本模板参考</a></p>
</div>


<div class="notices note" ><p>该脚本将循环处理Flanker数据集中的所有受试者，并为每次运行做预处理和统计分析。这需要的时间取决于你的机器有多快，但应该需要2-4小时左右。请确保对每个被试进行质量检查，就像在<a href="/fsl/preprocess/">预处理教程</a>中做的那样。</p>
</div>



<footer class="footline">
	
</footer>

<script src="https://giscus.app/client.js"
        data-repo="LiaoPan/LiaoPan.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzExMTkyMzc="
        data-category="General"
        data-category-id="DIC_kwDOB9C4hc4CTbqq"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
        
        </div>
        <script src="https://giscus.app/client.js"
        data-repo="LiaoPan/LiaoPan.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzExMTkyMzc="
        data-category="General"
        data-category-id="DIC_kwDOB9C4hc4CTbqq"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/fsl/roi_analysis/" title="FSL系列教程 #4. ROI分析 "> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/spm/" title="SPM系列教程" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1701594111"></script>
    <script src="/js/perfect-scrollbar.min.js?1701594111"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1701594111"></script>
    <script src="/js/jquery.sticky.js?1701594111"></script>
    <script src="/js/featherlight.min.js?1701594111"></script>
    <script src="/js/highlight.pack.js?1701594111"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1701594111"></script>
    <script src="/js/learn.js?1701594111"></script>
    <script src="/js/hugo-learn.js?1701594111"></script>
    
        
            <script src="/mermaid/mermaid.js?1701594111"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

